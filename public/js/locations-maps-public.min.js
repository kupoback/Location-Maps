function tooltipBuild(d){var c=d.title,a=d.address,b=d.url;return'<div class="marker-infowindow"><div class="title">'+c+"</div>"+placeAddress(a)+'<div class="link"><a href="'+b+'" target="_blank" rel="noopener">View on Google Maps</a></div></div>'}function placeAddress(f){var a=f.address,e=f.city,c=f.state,b=f.zip,d=f.country;return'<div class="address"><p>'+a+"</p><p>"+e+" "+c+" "+b+"</p><p>"+d+"</p></div>"}var map,mapElement=jQuery(".map-container").attr("id"),postsURL="/wp-json/wp/v2/locations?per_page=100",zoom=MAP_VARS.mapZoom||8,icon=MAP_VARS.mapIcon,hoverIcon=MAP_VARS.mapHoverIcon||"",style=MAP_VARS.mapStyling,catID=MAP_VARS.mapCatIds||"",termId=MAP_VARS.mapTermId||"",showTerms=MAP_VARS.showTerms||"",single=MAP_VARS.single||"no",defaultIcon=MAP_VARS.mapIcon,popup=MAP_VARS.mapPopup||"",prev_infowindow=false,label=1,markers=[],markerArray=[],cats=[],count,items,noInfoWindow=MAP_VARS.mapDisableInfowindow||"yes",center;function initMap(){if(catID!==""){postsURL="/wp-json/wp/v2/locations?per_page=100&map-cat="+catID}else{if(termId!==""||showTerms!==""){postsURL="/wp-json/wp/v2/offices?order=desc"}else{if(single!=="no"){postsURL="/wp-json/wp/v2/locations/"+single}}}center=new google.maps.LatLng(MAP_VARS.mapCenterLat,MAP_VARS.mapCenterLng);map=new google.maps.Map(document.getElementById(mapElement),{zoom:parseInt(zoom),center:center,disableDefaultUI:true,streetViewControl:false,mapTypeControl:false,mapTypeIds:["styledMap"]});jQuery.getJSON(style,function(c){var b=new google.maps.StyledMapType(c,{name:"Custom Map Styling"});map.mapTypes.set("styledMap",b);map.setMapTypeId("styledMap")});if(single==="no"){jQuery.ajax({url:postsURL,method:"GET",success:function(g){var b,e,j=1,h="",d="",f=new google.maps.LatLngBounds(),c=9999;g.forEach(function(s){if(termId&&termId!==s.id){return}var r;if(termId){r=new google.maps.LatLng(s.map_fields._map_lat,s.map_fields._map_lng)}else{r=new google.maps.LatLng(s.map_fields._map_lat,s.map_fields._map_lng)}f.extend(r);var o=new google.maps.Marker({position:r,map:map,icon:defaultIcon||icon});var q=s.map_fields._map_address[0]!==""?s.map_fields._map_address[0].replace(/\s/g,"+")+"+":"",k=s.map_fields._map_city[0]!==""?s.map_fields._map_city[0].replace(/\s/g,"+")+"+":"",p=s.map_fields._map_state[0]!==""?s.map_fields._map_state[0]+"+":"",t=s.map_fields._map_zip[0]!==""?s.map_fields._map_zip[0]+"+":"",i=q+k+p+t;var l={title:s.title.rendered||s.name||"",address:{address:s.map_fields._map_address,city:s.map_fields._map_city+","||"",state:s.map_fields._map_state||"",zip:s.map_fields._map_zip||""},url:"https://www.google.com/maps/search/?api=1&query="+i+"&query_place_id="+s.map_fields._map_placeID+">"};if(popup!==false){var n=tooltipBuild(l);var m=new google.maps.InfoWindow({content:n});google.maps.event.addListener(o,"click",(function(u,v){return function(){if(!jQuery.isEmptyObject(prev_infowindow)){prev_infowindow.close()}m=new google.maps.InfoWindow({content:n});prev_infowindow=m;m.open(map,u)}})(o,e))}if(hoverIcon.length){o.addListener("mouseover",function(){o.setIcon(MAP_VARS.hoverIcon)});o.addListener("mouseout",function(){o.setIcon(defaultIcon)});o.addListener("click",function(){o.setIcon(MAP_VARS.hoverIcon)})}o.setVisible(true);markers.push(o);o.setZIndex(google.maps.Marker.MAX_ZINDEX+1);if(s.id===29){o.setZIndex(9999999999)}google.maps.event.addListener(map,"click",function(){m.close()})})},error:function(d,b,c){console.log("error");console.log(d);console.log(b);console.log(c)}})}else{if(!isNaN(single)){var a=new google.maps.Marker({position:center,icon:icon});a.setMap(map)}}};